let selectedFilters={};function getAllKeys(e){let t=new Set;return e.forEach(e=>{Object.keys(e).forEach(e=>t.add(e))}),Array.from(t)}function getUniqueValues(e,t){let r=new Set;return e.forEach(e=>{e[t]&&r.add(e[t])}),Array.from(r)}function openFilterModal(){0<document.querySelector("#list-tab").children.length||populateFilterOptions(),updateCheckboxStates(),updateClearFiltersButtonStyle()}function updateCheckboxStates(){var e=document.getElementById("nav-tabContent");Array.from(e.children).forEach(e=>{let r=e.id.replace("list-","").replace(/-/g," ");e.querySelectorAll('input[type="checkbox"]').forEach(e=>{var t=e.id,t=e.dataset.filterValue||t.split("filter-checkbox-")[1].split("-").slice(1).join("-"),t=selectedFilters[r]&&selectedFilters[r].includes(t),e=(e.checked=t,e.nextElementSibling);t?e.style.fontWeight="bold":(e.style.fontWeight="normal",e.style.background="none")})})}function populateTabValues(n,s){if(s){let d=n.replace(/ /g,"-");var e=getUniqueValues(productsData.productDirectory,n);s.innerHTML="",e.forEach((e,t)=>{var r=document.createElement("div"),a=(r.className="form-check",document.createElement("input")),c=(a.type="checkbox",a.className="form-check-input me-1",e.replace(/ /g,"-")),c=`filter-checkbox-${d}-`+c,o=(a.id=c,a.dataset.filterKey=n,a.dataset.filterValue=e,selectedFilters[n]&&selectedFilters[n].includes(e)),l=(a.checked=o,a.addEventListener("change",function(e){updateSelectedFilters(this.dataset.filterKey,this.dataset.filterValue)}),document.createElement("label"));l.className="form-check-label",l.setAttribute("for",c),l.textContent=e,o&&(l.style.fontWeight="bold"),r.appendChild(a),r.appendChild(l),s.appendChild(r)})}else console.error("Tab pane is null for key:",n)}function populateFilterOptions(){let o=document.getElementById("list-tab"),l=document.getElementById("nav-tabContent");o.innerHTML="",l.innerHTML="",getAllKeys(productsData.productDirectory).forEach((r,t)=>{if("Product"!==r&&"Group Alias"!==r&&"Prod. Category"!==r){var a=r.replace(/ /g,"-"),c=document.createElement("a");c.classList.add("list-group-item","list-group-item-action"),0===t&&c.classList.add("active"),c.id=`list-${a}-list`,c.setAttribute("data-bs-toggle","list"),c.href="#list-"+a,c.role="tab",c.setAttribute("aria-controls","list-"+a),c.textContent=r,c.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),o.querySelectorAll(".active").forEach(e=>{e.classList.remove("active")}),l.querySelectorAll(".active, .show").forEach(e=>{e.classList.remove("active","show")}),this.classList.add("active");var e=this.getAttribute("href"),t=document.querySelector(e);t?(t.classList.add("active","show"),populateTabValues(r,t)):console.error("Target pane not found:",e)}),o.appendChild(c);let e=document.createElement("div");e.classList.add("tab-pane","fade"),0===t&&e.classList.add("show","active"),e.id="list-"+a,e.role="tabpanel",e.setAttribute("aria-labelledby",`list-${a}-list`),l.appendChild(e),0===t&&setTimeout(()=>populateTabValues(r,e),0)}})}function updateSelectedFilters(e,t){selectedFilters[e]||(selectedFilters[e]=[]);var r=selectedFilters[e].indexOf(t),r=(-1<r?(selectedFilters[e].splice(r,1),0===selectedFilters[e].length&&delete selectedFilters[e]):selectedFilters[e].push(t),document.getElementById("nav-tabContent"));Array.from(r.children).forEach(e=>{var t=e.id.replace("list-","").replace(/-/g," ");e.classList.contains("active")&&populateTabValues(t,e)}),updateClearFiltersButtonStyle()}function applyFilters(){0===Object.keys(selectedFilters).length?(displayProducts(productsData.productDirectory),updateCheckboxStates(),updateClearFiltersButtonStyle()):displayProducts(filterProductsBySelectedFilters(selectedFilters))}function clearFilters(){selectedFilters={},updateCheckboxStates(),updateClearFiltersButtonStyle(),applyFilters()}function filterProductsBySelectedFilters(r){return productsData.productDirectory.filter(e=>{for(var t in r)if(!r[t].includes(String(e[t])))return!1;return!0})}function updateClearFiltersButtonStyle(){var e=document.getElementById("filterProductList"),t=document.getElementById("clearFilters");0<Object.keys(selectedFilters).length?(e.style.backgroundColor="darkblue",t.style.backgroundColor="black",t.style.color="white"):(e.style.backgroundColor="",t.style.backgroundColor="",t.style.color="")}let currentFocusIndex=-1;document.addEventListener("keydown",function(e){var t=document.getElementById("search-box"),r=document.getElementById("filter-modal"),a=document.getElementById("order-modal"),r=r.classList.contains("show"),a=a.classList.contains("show");r||a?a?/^[0-9]$/.test(e.key)?(e.preventDefault(),appendToQuantity(e.key)):"Backspace"===e.key?(e.preventDefault(),clearLastDigit()):"Delete"===e.key?(e.preventDefault(),document.getElementById("clearAllDigits").click()):"Enter"===e.key&&(e.preventDefault(),document.getElementById("addToOrder").click()):e.preventDefault():e.ctrlKey&&e.shiftKey&&"F"===e.key?(e.preventDefault(),document.getElementById("filterProductList").click()):e.ctrlKey&&e.shiftKey&&"O"===e.key?(e.preventDefault(),document.getElementById("clearFilters").click()):e.ctrlKey&&"Delete"===e.key?(e.preventDefault(),clearOrder()):e.ctrlKey&&"Enter"===e.key?(e.preventDefault(),sendOrder()):(/^[a-zA-Z0-9]$/.test(e.key)&&(e.preventDefault(),r=t.selectionStart,t.focus(),t.value=t.value.slice(0,r)+e.key+t.value.slice(r),t.setSelectionRange(r+1,r+1),a=new Event("input",{bubbles:!0}),t.dispatchEvent(a)),"Backspace"===e.key&&(e.preventDefault(),0<(r=t.selectionStart)&&(t.focus(),t.value=t.value.slice(0,r-1)+t.value.slice(r),t.setSelectionRange(r-1,r-1)),a=new Event("input",{bubbles:!0}),t.dispatchEvent(a)),"Delete"===e.key&&(e.preventDefault(),(r=t.selectionStart)<t.value.length&&(t.focus(),t.value=t.value.slice(0,r)+t.value.slice(r+1)),t.setSelectionRange(r,r),a=new Event("input",{bubbles:!0}),t.dispatchEvent(a)),r=document.getElementById("product-list"),a=Array.from(r.children).filter(e=>"none"!==getComputedStyle(e).display),"ArrowDown"!==e.key&&"ArrowUp"!==e.key||(e.preventDefault(),"ArrowDown"===e.key&&(-1===currentFocusIndex?(currentFocusIndex=1,a[0]?.classList.add("focus"),a[0]?.scrollIntoView({block:"nearest"}),a[0]?.focus?.()):0<currentFocusIndex&&currentFocusIndex<=a.length&&(a[currentFocusIndex-1]?.classList.remove("focus"),currentFocusIndex<a.length&&(a[currentFocusIndex]?.classList.add("focus"),a[currentFocusIndex]?.scrollIntoView({block:"nearest"})),currentFocusIndex++)),"ArrowUp"===e.key&&(1===currentFocusIndex?(a[0]?.classList.remove("focus"),t.focus(),currentFocusIndex=-1):1<currentFocusIndex&&(a[currentFocusIndex-1]?.classList.remove("focus"),a[currentFocusIndex-2]?.classList.add("focus"),a[currentFocusIndex-2]?.scrollIntoView({block:"nearest"}),currentFocusIndex--))),"Enter"===e.key&&0<currentFocusIndex&&(e.preventDefault(),a[currentFocusIndex-1]?.click()))}),window.onload=loadProducts();let productsData,openedProductForOrder;async function loadProducts(){try{var e=await fetch("products.json");displayProducts((productsData=await e.json()).productDirectory)}catch(e){console.error("Error loading products:",e)}}function displayProducts(e){var t=document.getElementById("product-list");t.innerHTML="";let o=document.createDocumentFragment();e.forEach(e=>{let t=document.createElement("li");t.classList.add("list-group-item","list-group-item-action"),t.setAttribute("data-bs-toggle","modal"),t.setAttribute("data-bs-target","#order-modal"),t.dataset.productName=e.Product,t.dataset.productType=e["Product Type"],t.dataset.productGroup=e["Group Name"],t.dataset.productGroupAlias=e["Group Alias"],t.dataset.productCategory=e["Prod. Category"],t.dataset.faceType=e["Face Type"],t.dataset.coreType=e["Core Type"],t.dataset.gradeType=e["Grade Type"],t.dataset.brandMark=e["Brand Mark"];var r=document.createElement("input"),a=(r.classList.add("form-check-input","me-2"),r.type="checkbox","checkbox-"+e.Product.replace(/\s/g,"-")),c=(r.id=a,document.createElement("label"));c.classList.add("form-check-label","fs-6","fw-semibold","stretched-link"),c.textContent=e.Product,c.setAttribute("for",a),t.appendChild(r),t.appendChild(c),t.onclick=()=>openOrderModal(t),o.appendChild(t)}),t.appendChild(o)}function openOrderModal(e){document.getElementById("modal-product-name").textContent=e.dataset.productName,document.getElementById("modal-product-type").innerHTML="<b>Product Type :</b> "+e.dataset.productType,document.getElementById("modal-face-type").innerHTML="<b>Face Type :</b> "+e.dataset.faceType,document.getElementById("modal-core-type").innerHTML="<b>Core Type :</b> "+e.dataset.coreType,document.getElementById("modal-grade-type").innerHTML="<b>Grade Type :</b> "+e.dataset.gradeType,document.getElementById("modal-brand-mark").innerHTML="<b>Brand Mark :</b> "+e.dataset.brandMark,openedProductForOrder=e}let selectedProducts=[],quantityInput=document.getElementById("quantity"),selectedProductsTextarea=document.getElementById("selected-products");function appendToQuantity(e){var t=document.getElementById("quantity");"0"===t.value?t.value=e:t.value+=e}function clearLastDigit(){var e=document.getElementById("quantity"),t=e.value;1<t.length?e.value=t.slice(0,-1):e.value="0"}function clearAllDigits(){document.getElementById("quantity").value="0"}function addToOrder(){let t=openedProductForOrder.dataset.productName;var e=openedProductForOrder.dataset.productGroup,r=openedProductForOrder.dataset.productGroupAlias,a=openedProductForOrder.dataset.productCategory,c=parseInt(quantityInput.value,10),o=document.getElementById("checkbox-"+t.replace(/\s/g,"-")),e={productName:t,productGroup:e,productGroupAlias:r,productCategory:a,quantity:c};0<c?(-1<(r=selectedProducts.findIndex(e=>e.productName===t))?selectedProducts[r]=e:selectedProducts.push(e),o.checked=!0,clearAllDigits()):(selectedProducts=selectedProducts.filter(e=>e.productName!==t),o.checked=!1),updateOrderList()}function clearOrder(){document.querySelectorAll('#product-list input[type="checkbox"]').forEach(e=>e.checked=!1),selectedProducts=[],updateOrderList(),clearSearch()}function updateOrderList(){var e=selectedProducts.map(e=>e.productName+" - "+e.quantity);selectedProductsTextarea.value=e.join("\n")+(`
Total: `+calculateTotalQuantity()),selectedProductsTextarea.scrollTop=selectedProductsTextarea.scrollHeight}function calculateTotalQuantity(){return selectedProducts.reduce((e,t)=>e+t.quantity,0)}let searchBox=document.getElementById("search-box");function scrollSearchBoxToTop(){var e=searchBox.getBoundingClientRect().top+window.scrollY;window.scrollTo({top:e-15,behavior:"smooth"})}function clearSearch(){searchBox.value="",filterProducts()}function filterProducts(){var t=searchBox.value.toUpperCase(),r=document.getElementById("product-list").getElementsByTagName("li");let a=!1;for(let e=0;e<r.length;e++)containsInOrder(r[e].dataset.productName.toUpperCase(),t)?(r[e].style.display="",a=!0):r[e].style.display="none";if(!a)for(let e=0;e<r.length;e++){var c=r[e].dataset.brandMark?r[e].dataset.brandMark.toUpperCase():"",o=r[e].dataset.coreType?r[e].dataset.coreType.toUpperCase():"",l=r[e].dataset.gradeType?r[e].dataset.gradeType.toUpperCase():"";containsInOrder(c,t)||containsInOrder(o,t)||containsInOrder(l,t)?r[e].style.display="":r[e].style.display="none"}}function containsInOrder(t,r){t=t.toUpperCase(),r=r.toUpperCase();let a=0;for(let e=0;e<r.length;e++){if(-1===(a=t.indexOf(r[e],a)))return!1;a++}return!0}function sendOrder(){if(0===selectedProducts.length)console.warn("No products in the order. Please add products to the order.");else{selectedProducts.sort((e,t)=>{var r,a=e.productGroupAlias.localeCompare(t.productGroupAlias);return 0===a?0===(r=e.productCategory.localeCompare(t.productCategory))?e.productName.localeCompare(t.productName):r:a});let c="",o=null;selectedProducts.forEach(e=>{var{productGroupAlias:t,productName:r,productGroup:a}=e;o!==t&&(c+=`
*${a}* :
`,o=t),c+=`${r} - ${e.quantity}\n`});var e=calculateTotalQuantity(),e=(c+=`
Total : *${e}* Pcs.
`,encodeURIComponent(c));window.open("https://wa.me/+916355360702?text="+e,"_blank")}}searchBox.addEventListener("focus",()=>{scrollSearchBoxToTop()}),searchBox.addEventListener("input",()=>{scrollSearchBoxToTop()});