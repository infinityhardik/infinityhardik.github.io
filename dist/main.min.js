function sendOrder(){if(0===parseInt(currentQuantity,10)||0===selectedProducts.length)console.warn("Quantity is zero or no products in the order. Please add products to the order.");else{selectedProducts.sort((e,t)=>{var r,o=e.product["Group Alias"].localeCompare(t.product["Group Alias"]);return 0===o?0===(r=e.product["Prod. Category"].localeCompare(t.product["Prod. Category"]))?e.product.Product.localeCompare(t.product.Product):r:o});let n="",c=null;selectedProducts.forEach(e=>{var{"Group Alias":t,Product:r,"Group Name":o}=e.product;c!==t&&(n+=`
*${o}* :
`,c=t),n+=`${r} - ${e.quantity}\n`});var e=calculateTotalQuantity(),e=(n+=`
Total : *${e}* Pcs.
`,encodeURIComponent(n));window.open("https://wa.me/+916355360702?text="+e,"_blank")}}function calculateTotalQuantity(){return selectedProducts.reduce((e,t)=>e+t.quantity,0)}let selectedFilters={};function getAllKeys(e){const t=new Set;return e.forEach(e=>{Object.keys(e).forEach(e=>t.add(e))}),Array.from(t)}function getUniqueValues(e,t){const r=new Set;return e.forEach(e=>{e[t]&&r.add(e[t])}),Array.from(r)}function openFilterModal(){var e=document.getElementById("filter-modal");populateFilterOptions(),setCheckboxStates(),e.style.display="block",updateClearFiltersButtonStyle()}function closeFilterModal(){document.getElementById("filter-modal").style.display="none"}function setCheckboxStates(){document.getElementById("filter-options").querySelectorAll('input[type="checkbox"]').forEach(e=>{var t=e.id.split("-"),r=t.findIndex(e=>"checkbox"===e),o=t.slice(r+1,r+3).join(" "),t=t.slice(r+3).join("-");o in selectedFilters&&selectedFilters[o].includes(t)?(e.checked=!0,e.nextElementSibling.style.fontWeight="bold",populateUniqueValues(o)):(e.checked=!1,e.nextElementSibling.style.fontWeight="normal",e.nextElementSibling.style.background="none")})}function populateFilterOptions(){const n=document.getElementById("list-tab"),c=document.getElementById("nav-tabContent");n.innerHTML="",c.innerHTML="",getAllKeys(productsData.productDirectory).forEach((e,t)=>{var r,o;"Product"!==e&&"Group Alias"!==e&&"Prod. Category"!==e&&(r=e.replace(/ /g,"-"),(o=document.createElement("a")).classList.add("list-group-item","list-group-item-action"),0===t&&o.classList.add("active"),o.id=`list-${r}-list`,o.setAttribute("data-bs-toggle","list"),o.href="#list-"+r,o.role="tab",o.setAttribute("aria-controls","list-"+r),o.textContent=e,o.addEventListener("click",()=>populateUniqueValues(e)),n.appendChild(o),(o=document.createElement("div")).classList.add("tab-pane","fade"),0===t&&o.classList.add("show","active"),o.id="list-"+r,o.role="tabpanel",o.setAttribute("aria-labelledby",`list-${r}-list`),c.appendChild(o))})}function populateUniqueValues(n){const c=n.replace(/ /g,"-"),l=document.getElementById("list-"+c);l.innerHTML="";var e=getUniqueValues(productsData.productDirectory,n);0===e.length?console.warn("No unique values found for key: "+n):e.forEach(e=>{var t=document.createElement("input"),r=(t.type="checkbox",t.id=`filter-checkbox-${c}-`+e,t.setAttribute("class","form-check-input me-1"),t.addEventListener("change",()=>updateSelectedFilters(n,e)),document.createElement("label")),o=(r.setAttribute("class","form-check-label"),r.setAttribute("for",`filter-checkbox-${c}-`+e),r.textContent=e,document.createElement("div"));o.appendChild(t),o.appendChild(r),l.appendChild(o)})}function updateSelectedFilters(e,t){selectedFilters[e]||(selectedFilters[e]=[]);var r=selectedFilters[e].indexOf(t);-1<r?selectedFilters[e].splice(r,1):selectedFilters[e].push(t),updateClearFiltersButtonStyle()}function applyFilters(){selectedFilters=getSelectedFilters(),updateClearFiltersButtonStyle(),0===Object.keys(selectedFilters).length?(clearFilters(),displayProducts(productsData.productDirectory)):(displayProducts(filterProductsBySelectedFilters(selectedFilters)),closeFilterModal())}function clearFilters(){selectedFilters={},document.getElementById("filter-options").querySelectorAll('input[type="checkbox"]').forEach(e=>{e.checked=!1}),displayProducts(productsData.productDirectory),updateClearFiltersButtonStyle()}function filterProductsBySelectedFilters(r){return productsData.productDirectory.filter(e=>{for(const t in r)if(!r[t].includes(String(e[t])))return!1;return!0})}function getSelectedFilters(){var e=document.getElementById("filter-options").querySelectorAll('input[type="checkbox"]');const o={};return e.forEach(e=>{var t,r;e.checked&&(t=(e=e.id.split("-")).findIndex(e=>"checkbox"===e),r=e.slice(t+1,t+3).join(" "),e=e.slice(t+3).join("-"),r in o||(o[r]=[]),o[r].push(e))}),o}function updateClearFiltersButtonStyle(){var e=document.getElementById("filterProductList"),t=document.getElementById("clearFilters");0<Object.keys(selectedFilters).length?(e.style.backgroundColor="darkblue",t.style.backgroundColor="black",t.style.color="white"):(e.style.backgroundColor="",t.style.backgroundColor="",t.style.color="")}async function loadProducts(){try{var e=await fetch("products.json");displayProducts((productsData=await e.json()).productDirectory)}catch(e){console.error("Error loading products:",e)}}function displayProducts(e){const c=document.getElementById("product-list");c.innerHTML="",e.forEach(e=>{var t=document.createElement("li"),r=(t.classList.add("align-items-center","list-group-item"),document.createElement("input")),o=(r.type="checkbox",r.classList.add("form-check-input","me-2"),"checkbox-"+e.Product.replace(/\s/g,"-")),n=(r.id=o,document.createElement("label"));n.classList.add("form-check-label","fs-6","fw-semibold","stretched-link"),n.innerHTML=e.Product,n.setAttribute("for",o),n.setAttribute("data-bs-toggle","modal"),n.setAttribute("data-bs-target","#order-modal"),t.appendChild(r),t.appendChild(n),t.onclick=()=>toggleProduct(e.Product),c.appendChild(t)})}function getProductDetails(t){return productsData&&productsData.productDirectory&&productsData.productDirectory.find(e=>e.Product===t)||{}}function openOrderModal(e){resetQuantityToZero();var t=document.getElementById("order-modal"),r=document.getElementById("modal-product-name"),o=getProductDetails(e);r.textContent=e,document.getElementById("modal-product-type").innerHTML="<b>Product Type :</b> "+o["Product Type"],document.getElementById("modal-face-type").innerHTML="<b>Face Type :</b> "+o["Face Type"],document.getElementById("modal-core-type").innerHTML="<b>Core Type :</b> "+o["Core Type"],document.getElementById("modal-grade-type").innerHTML="<b>Grade Type :</b> "+o["Grade Type"],document.getElementById("modal-brand-mark").innerHTML="<b>Brand Mark :</b> "+o["Brand Mark"],t.style.display="block"}function closeOrderModal(e){var t=document.getElementById("order-modal"),r=document.getElementById("quantity");const o=document.getElementById("modal-product-name").textContent;e&&"keydown"===e.type&&"Escape"===e.key&&(r.value="0"),0===parseInt(r.value,10)&&document.querySelectorAll('#product-list input[type="checkbox"]').forEach(e=>{e.nextElementSibling.textContent===o&&(e.checked=!1)}),t.style.display="none"}function toggleProduct(t){var e=document.getElementById("checkbox-"+t.replace(/\s/g,"-")),r=selectedProducts.findIndex(e=>e.product.Product===t);e.checked=!e.checked,(e.checked&-1===r?(openOrderModal(t),resetQuantityToZero):(selectedProducts=selectedProducts.filter(e=>e.product.Product!==t),updateOrderList))()}window.onload=loadProducts,document.addEventListener("keydown",closeOrderModal);let selectedProducts=[],productsData;function addToOrder(){var e=document.getElementById("quantity");const t=document.getElementById("modal-product-name").textContent;var r,e=parseInt(e.value,10);0<e?(r=getProductDetails(t))&&0<Object.keys(r).length?(selectedProducts.push({product:r,quantity:e}),updateOrderList()):console.error("Product details not found for:",t):(r=document.querySelectorAll('#product-list input[type="checkbox"]'),(e=Array.from(r).find(e=>{e=e.nextElementSibling;return e&&(e.textContent||e.innerText)===t}))&&(e.checked=!0),e.checked=!1),closeOrderModal()}function clearOrder(){document.querySelectorAll('#product-list input[type="checkbox"]').forEach(e=>e.checked=!1),selectedProducts=[],updateOrderList(),clearSearch()}function updateOrderList(){var e=document.getElementById("selected-products");e.value=selectedProducts.map(e=>e.product.Product+" - "+e.quantity).join("\n")+(`
Total : `+calculateTotalQuantity()),e.scrollTop=e.scrollHeight}let currentQuantity="0";function appendToQuantity(e){"0"===currentQuantity?currentQuantity=e:currentQuantity+=e,updateQuantityInput()}function clearLastDigit(){""===(currentQuantity=currentQuantity.slice(0,-1))&&(currentQuantity="0"),updateQuantityInput()}function updateQuantityInput(){document.getElementById("quantity").value=currentQuantity}function clearAllDigits(){currentQuantity="0",updateQuantityInput()}function resetQuantityToZero(){currentQuantity="0",updateQuantityInput()}const searchBox=document.getElementById("search-box");function scrollSearchBoxToTop(){searchBox.scrollIntoView({behavior:"smooth",block:"start"})}function clearSearch(){document.getElementById("search-box").value="",filterProducts(),document.body.scrollIntoView({behavior:"smooth"})}function filterProducts(){var t=document.getElementById("search-box").value.toUpperCase(),r=document.getElementById("product-list").getElementsByTagName("li");for(let e=0;e<r.length;e++){var o=r[e].getElementsByTagName("label")[0];containsInOrder(o.textContent||o.innerText,t)?r[e].style.display="":r[e].style.display="none"}}function containsInOrder(t,r){t=t.toUpperCase(),r=r.toUpperCase();let o=0;for(let e=0;e<r.length;e++){if(-1===(o=t.indexOf(r[e],o)))return!1;o++}return!0}searchBox.addEventListener("focus",()=>{scrollSearchBoxToTop()}),searchBox.addEventListener("input",()=>{scrollSearchBoxToTop()});